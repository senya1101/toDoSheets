package com.example.todolistapp.database

import com.example.todolistapp.models.Tag
import com.example.todolistapp.database.dao.TagDao
import kotlinx.coroutines.flow.first

// –û–±—ä–µ–∫—Ç –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
object DatabaseInitializer {

    // –ú–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤, –µ—Å–ª–∏ –∏—Ö –µ—â—ë –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ
    suspend fun initializeDefaultTags(tagDao: TagDao) {
        // –°–æ–∑–¥–∞—ë–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤ —Å —ç–º–æ–¥–∑–∏ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
        val defaultTags = listOf(
            Tag(name = "üè¢ –†–∞–±–æ—Ç–∞"),     // –¢–µ–≥ –¥–ª—è —Ä–∞–±–æ—Ç—ã
            Tag(name = "üè† –î–æ–º"),        // –¢–µ–≥ –¥–ª—è –¥–æ–º–∞
            Tag(name = "‚≠ê –°—Ä–æ—á–Ω–æ"),     // –í–∞–∂–Ω—ã–π –∏–ª–∏ —Å—Ä–æ—á–Ω—ã–π
            Tag(name = "‚ö° –í–∞–∂–Ω–æ"),      // –¢–µ–≥ –¥–ª—è –æ—Å–æ–±–æ –≤–∞–∂–Ω–æ–≥–æ
            Tag(name = "üìö –û–±—É—á–µ–Ω–∏–µ"),  // –î–ª—è —É—á–µ–±–Ω—ã—Ö –∑–∞–¥–∞—á
            Tag(name = "üèãÔ∏è –ó–¥–æ—Ä–æ–≤—å–µ"),  // –î–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏ –∑–¥–æ—Ä–æ–≤—å—è
            Tag(name = "üõí –ü–æ–∫—É–ø–∫–∏"),    // –î–ª—è —Å–ø–∏—Å–∫–∞ –ø–æ–∫—É–ø–æ–∫
            Tag(name = "ü§ù –°–æ—Ü–∏—É–º")      // –î–ª—è —Å–æ—Ü–∑–∞–¥–∞—á, –≤—Å—Ç—Ä–µ—á –∏ —Ç.–ø.
        )

        // –ü–æ–ª—É—á–∞–µ–º –∏–∑ –±–∞–∑—ã –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏ (—Å–µ–π—á–∞—Å ‚Äî –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫)
        val existingTags = tagDao.getAllTags().first()

        // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å–ø–∏—Å–∫—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤
        defaultTags.forEach { tag ->
            // –ï—Å–ª–∏ —Ç–∞–∫–æ–≥–æ —Ç–µ–≥–∞ –µ—â—ë –Ω–µ—Ç –≤ –±–∞–∑–µ ‚Äî –≤—Å—Ç–∞–≤–ª—è–µ–º
            if (!existingTags.any { it.name == tag.name }) {
                tagDao.insertTag(tag)
            }
        }
    }
}
